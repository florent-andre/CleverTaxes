<!DOCTYPE html>
<html>
  <head>
    <title>CouchDB jQuery Examples</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <script src="http://127.0.0.1:5984/_utils/script/json2.js"></script>
    <script src="http://127.0.0.1:5984/_utils/script/sha1.js"></script>
    <script src="http://127.0.0.1:5984/_utils/script/jquery.js?1.4.2"></script>
    <script src="http://127.0.0.1:5984/_utils/script/jquery.couch.js?0.11.0"></script>
    <script src="http://127.0.0.1:5984/_utils/script/jquery.dialog.js?0.11.0"></script>
  </head>
  <body>
  <script>
//pour lancer la page
//http://127.0.0.1:5984/graphs/webpage/testCouchDB.html
 $.couch.urlPrefix = "http://127.0.0.1:5984";
 $.couch.db("graphs").allDesignDocs({
   success: function(data) {
   console.log(data);
   },
  error: function(status) {
   console.log(status);
 }
 });
 //http://127.0.0.1:5984/_utils/database.html?graphs/_design/lines/_view/lines
 $.couch.db("graphs").view("lines/lines", {
    success: function(data) {
      console.log(data);
    },
    error: function(status) {
      console.log(status);
    },
    group: true //pour executer la fonction on reduce
});
/*
  //$.couch.info({
  $.couch.allDbs({
    success: function(data) {
        console.log(data);
    }
  });

  $.couch.db("graphs").openDoc("509732cf7dc2e098e9173861660008e0", {
    success: function(data) {
    console.log(data);
    },
   error: function(status) {
    console.log(status);
  }
  });

  var doc = {
  "name": "wiem2",
  "lines": [
       {
           "id": 1,
           "label": "Économie ",
           "amount": 200.89,
           "percentage": 0.5444153439
       },
       {
           "id": 2,
           "label": "Écologie, développement et aménagement durables ",
           "amount": 10017.07,
           "percentage": 2.6500185185
       },
       {
           "id": 3,
           "label": "Ville et logement ",
           "amount": 7593.21,
           "percentage": 2.0087857143
       },
       {
           "id": 4,
           "label": "Travail et emploi ",
           "amount": 12349.82,
           "percentage": 3.2671481481
       }
   ]
    };
    $.couch.db("graphs").saveDoc(doc, {
      success: function(data) {
      console.log(data);
    },
    error: function(status) {
    console.log(status);
  }
  });
  /*
/*
 $.ajax({
    url : 'http://127.0.0.1:5984/_utils/database.html?graphs/_design/graphs/_view/graphs',
    type : 'GET',
    dataType : "json",
    success : function(json) {
      console.log ("data");
    }
  });
  */
  </script>

</body>
</html>
